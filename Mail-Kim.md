Dear Fellow,

I’m writing to you as our cloud security tells that you are one out of 94 users, that have been using NPM last 90 days.  

I’m keen to let you know that a large-scale supply chain attack on the ecosystem around NPM is ongoing, starting last week, please be aware and take you precautions

**Brief from Threatmatch (Our trust threat analysis partner)**

**Summary**

A large-scale supply-chain attack attributed to the Shai-Hulud 2.0 malware campaign has compromised over 800 npm packages and select Maven components, targeting major ecosystems including Zapier, PostHog, ENS Domains, Postman, and AsyncAPI. The campaign exfiltrates developer secrets to GitHub repositories, escalates privileges in CI/CD environments, and includes a destructive fallback mechanism. The malware spreads autonomously by harvesting tokens and publishing trojanized package updates using compromised maintainer credentials.

**Overview**

A renewed Shai-Hulud malware campaign, dubbed "Sha1-Hulud: The Second Coming," has rapidly compromised over 800 npm packages and multiple mirrored Maven packages, impacting more than 25,000 GitHub repositories. The malware operates during the preinstall phase via injected lifecycle scripts (setup\_bun.js and bun\_environment.js) and executes immediately during package installation without user interaction. Targeted projects include widely used packages from Zapier, PostHog, Postman, ENS Domains, and AsyncAPI.

The malware collects secrets from developer environments and CI/CD systems—including GitHub tokens, npm credentials, and cloud provider access keys (AWS, Azure, GCP). Stolen secrets are exfiltrated to public GitHub repositories with identifiers such as “Sha1-Hulud: The Second Coming,” often under victim-owned accounts. Repositories are populated with files including environment.json, cloud.json, and truffleSecrets.json. GitHub has been actively removing these repositories, but attackers continue to create new ones rapidly.

Infected environments are further leveraged to propagate the malware. Valid npm tokens are used to trojanize and republish up to 100 packages per maintainer, automating spread. On GitHub Actions runners, the malware deploys backdoors by registering the runner as a self-hosted agent (SHA1HULUD) and creates a malicious discussion.yaml workflow that allows remote code execution via GitHub Discussions. A second workflow (formatter\_\*.yml) is used to steal all defined GitHub secrets by uploading them as artifacts.

A destructive fallback is triggered when exfiltration fails—if GitHub or npm authentication cannot be established, the malware overwrites and deletes the entire home directory of the infected user. This introduces the risk of significant disruption, especially in CI/CD pipelines and developer systems. The payload is heavily obfuscated and includes anti-analysis mechanisms.

Wider impact includes cross-victim data exposure, where secrets from one environment may appear in public repositories of another victim. The campaign has also affected Maven Central, which mirrored malicious npm packages under the org.mvnpm namespace. These have since been removed, but highlight the reach of the infection.

**References:**  
[https://securitylabs.datadoghq.com/articles/shai-hulud-2.0-npm-worm/](https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fshai-hulud-2.0-npm-worm%2F&amp;data=05%7C02%7Cfilip.lindboe%40fellowmind.dk%7C299fc5c0e6474692cf8508de31b346f4%7Cc905c127525f47a983f1bec014f6d613%7C0%7C0%7C639002843231806307%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&amp;sdata=M60w3yK1uJaCkUbMXnh%2FQlNE3b4GN7tPY8%2BDAHAxbYI%3D&amp;reserved=0 "Original URL: https://securitylabs.datadoghq.com/articles/shai-hulud-2.0-npm-worm/. Click or tap if you trust this link.")  
[https://unit42.paloaltonetworks.com/npm-supply-chain-attack/](https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnpm-supply-chain-attack%2F&amp;data=05%7C02%7Cfilip.lindboe%40fellowmind.dk%7C299fc5c0e6474692cf8508de31b346f4%7Cc905c127525f47a983f1bec014f6d613%7C0%7C0%7C639002843231828813%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&amp;sdata=lGo%2BDUlewCHwI5xQ%2F0IyBzpOQKoU%2BCFciSM8a5%2BLmbQ%3D&amp;reserved=0 "Original URL: https://unit42.paloaltonetworks.com/npm-supply-chain-attack/. Click or tap if you trust this link.")  
[https://socket.dev/blog/shai-hulud-strikes-again-v2](https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fsocket.dev%2Fblog%2Fshai-hulud-strikes-again-v2&amp;data=05%7C02%7Cfilip.lindboe%40fellowmind.dk%7C299fc5c0e6474692cf8508de31b346f4%7Cc905c127525f47a983f1bec014f6d613%7C0%7C0%7C639002843231844987%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&amp;sdata=N%2BUvo4LF0nFpLbC%2B6Lv3DCQEhCjnWnLmWe3KtILERFQ%3D&amp;reserved=0 "Original URL: https://socket.dev/blog/shai-hulud-strikes-again-v2. Click or tap if you trust this link.")  
[https://www.koi.ai/incident/live-updates-sha1-hulud-the-second-coming-hundred-npm-packages-compromised](https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.koi.ai%2Fincident%2Flive-updates-sha1-hulud-the-second-coming-hundred-npm-packages-compromised&amp;data=05%7C02%7Cfilip.lindboe%40fellowmind.dk%7C299fc5c0e6474692cf8508de31b346f4%7Cc905c127525f47a983f1bec014f6d613%7C0%7C0%7C639002843231860015%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&amp;sdata=MfJquIn5wuudKJCSI6Ma5EnPN1lqNmRZxCQr2vhLFIo%3D&amp;reserved=0 "Original URL: https://www.koi.ai/incident/live-updates-sha1-hulud-the-second-coming-hundred-npm-packages-compromised. Click or tap if you trust this link.")

Two security researchers have made and after match article on Trends, Victimology, and Impact, which you can be used to assess.

[https://www.wiz.io/blog/shai-hulud-2-0-aftermath-ongoing-supply-chain-attack](https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.wiz.io%2Fblog%2Fshai-hulud-2-0-aftermath-ongoing-supply-chain-attack&amp;data=05%7C02%7Cfilip.lindboe%40fellowmind.dk%7C299fc5c0e6474692cf8508de31b346f4%7Cc905c127525f47a983f1bec014f6d613%7C0%7C0%7C639002843231875666%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&amp;sdata=nBEwYcNta4wkx0a%2FN4ReCcUgO142D7g40x66112i%2FpE%3D&amp;reserved=0 "Original URL: https://www.wiz.io/blog/shai-hulud-2-0-aftermath-ongoing-supply-chain-attack. Click or tap if you trust this link.")

Today our Swedish Fellow, Matthias Uldin, have developed a PowerShell script, that scans directories with development projects and directories with globally installed packages based on available information about the worm's approach. The script can be downloaded here and is available to everyone within Fellowmind.

[Powershell script to detect Shai-Hulud 2.0](https://orangoab-my.sharepoint.com/:f:/g/personal/mattias_uldin_fellowmind_se/IgC2QYFbTFqlRapfv4gQkBx_AfsrwlT9Ng1u2GahOV85RXA?e=Nnbv4k&amp;xsdata=MDV8MDJ8ZmlsaXAubGluZGJvZUBmZWxsb3dtaW5kLmRrfDI5OWZjNWMwZTY0NzQ2OTJjZjg1MDhkZTMxYjM0NmY0fGM5MDVjMTI3NTI1ZjQ3YTk4M2YxYmVjMDE0ZjZkNjEzfDB8MHw2MzkwMDI4NDMyMzE4OTE1ODZ8VW5rbm93bnxUV0ZwYkdac2IzZDhleUpGYlhCMGVVMWhjR2tpT25SeWRXVXNJbFlpT2lJd0xqQXVNREF3TUNJc0lsQWlPaUpYYVc0ek1pSXNJa0ZPSWpvaVRXRnBiQ0lzSWxkVUlqb3lmUT09fDB8fHw%3d&amp;sdata=WlRiU3V1MVkyR2ZBeUVOOS9oV05OZVZBQTJ6eDFuYkdIMi9BYnZmUDFiQT0%3d "Original URL: https://orangoab-my.sharepoint.com/:f:/g/personal/mattias_uldin_fellowmind_se/IgC2QYFbTFqlRapfv4gQkBx_AfsrwlT9Ng1u2GahOV85RXA?e=Nnbv4k. Click or tap if you trust this link.")

Please reach out to each other to collaborate and minimize the likelihood of us being hit by Shai-Hulud 2.0.